---
title: "Flexibility/Vertebral Measurement Comparison"
output: html_notebook
---

En = transverse flexibility
Qn = cross sectional area ratios
Gn = cross sectional shape indices
Vn = # of elastic joints in axial skeleton

```{r}
library(tidyverse)
library(ggplot2)
library(Hmisc)
library(rfishbase)
```

#Load in Vertebrae Measurements and Aleyev Flexibility Data
```{r}
newvertmeas <- read.csv("AllVertMeasurements.csv", header = TRUE, skip = 1)

newvertmeas
```

```{r}
newvertmeasmean <- newvertmeas %>%
  group_by(Species, Indiv) %>%
  select(SL, CBL, d, alpha_Pos, alpha_Ant, D_Pos, D_Ant) %>%
  summarize_all(mean, na.rm=TRUE) %>%
  ungroup()

newvertmeasmean
```


```{r}
vertflex <- read.csv("Aleyev Table 6 Digitization.csv")

vertflex
```

#Take Mean for Vertebrae Measurements and Flexibility Data
```{r}
vertflexmean <- vertflex %>%
  group_by(MatchSpecies) %>% 
  select(En, Qn, Gn, Vn) %>%
  summarize_all(mean, na.rm = TRUE) %>%
  ungroup()

vertflexmean
```

#Joining the Aleyev and Vertebral Measurement Plots 
```{r}
vertmeasflexjoin<- inner_join(newvertmeasmean, vertflexmean, by = c("Species" = "MatchSpecies"))

vertmeasflexjoin
```


#Preliminary Plots for VertMeas/En Means Comparisons
```{r}
ggplot(vertmeasflexjoin, aes(x = d, y = En)) + geom_point(color = "purple")
```
This is bizarre...but when I did the math for the means of the En value for each species this is what it came out to be...I guess I don't fully understand the concept of transverse flexibility? 

```{r}
ggplot(vertmeasflexjoin, aes(x = CBL, y = En)) + geom_point(color = "light green")
```

```{r}
ggplot(vertmeasflexjoin, aes(x = d, y = Gn)) + geom_point(color = "navy blue")
```

```{r}
ggplot(vertmeasflexjoin, aes(x = CBL, y = Gn)) + geom_point(color = "red")
```

```{r}
ggplot(vertmeasflexjoin, aes(x = d, y = Qn)) + geom_point(color = "blue")
```

```{r}
ggplot(vertmeasflexjoin, aes(x = CBL, y = Qn)) + geom_point(color = "orange")
```


